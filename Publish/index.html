<!DOCTYPE html>
<html lang="en" class="h-100">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <script
            src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"
        ></script>

        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
            crossorigin="anonymous"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"
        ></script>

        <title>手机安装BMW Linker小组件指导</title>
    </head>
    <body class="d-flex flex-column h-100">
        <div class="weixin-tip">
            <p>
                <img src="assets/leave_wechat.png" alt="微信打开" />
            </p>
        </div>
        <main class="flex-shrink-0">
            <div class="container text-center">
                <h3 class="mt-5">手机安装BMW Linker小组件指导</h3>
                <br />
                <br />
                <h5>1. 下载安装 Scriptable App</h5>
                <div>
                    <a
                        class="appStoreLink"
                        href="https://apps.apple.com/cn/app/scriptable/id1405459188"
                        target="_blank"
                    >
                        <img
                            class="appStore img-fluid"
                            style="max-width: 40%"
                            src="assets/appstore.png"
                            alt="App Store"
                        />
                    </a>
                </div>
                <br />
                <br />
                <div>
                    <h5>2. 点击 复制代码</h5>
                    <a type="button" id="copy" onclick="copy()" class="btn btn-success" disabled href="#">复制代码</a>
                    <textarea id="js-text-area" rows="20" readonly style="min-width: 400px"></textarea>
                </div>
                <br />
                <br />
                <div>
                    <h5>3. 点击 打开Scriptable, 点击 ➕，粘贴至空白处，运行 ▶️</h5>
                    <a id="open" type="button" class="btn btn-info" href="scriptable:///add?scriptName=BMW_LINKER安装器"
                        >打开 Scriptable</a
                    >
                </div>
                <br />
                <br />
                <br />
                <div>
                    <a href="https://docs.qq.com/doc/DT2RNTml4d1hmSmlh" target="_blank">帮助文档</a>
                </div>
                <br />
                <br />
                <br />
                <br />
                <div>
                    <small class="text-muted">
                        *开发者 Yocky ，感谢 Popo 提供 UI 设计，感谢胡总、吹雪和部分群友，提供思路帮助与测试。
                        <br />本小组件是开源免费的，由BMW车主开发，所有责任与BMW公司无关。</small
                    >
                </div>
            </div>
        </main>
        <footer class="footer mt-auto py-3 bg-light">
            <div class="container text-center">
                <span class="text-muted"> Copyright © 2021 Yocky Xiang </span>
            </div>
        </footer>
    </body>
    <style>
        #js-text-area {
            display: none;
        }

        * {
            margin: 0;
            padding: 0;
        }
        a {
            text-decoration: none;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        .weixin-tip {
            display: none;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            filter: alpha(opacity=80);
            height: 100%;
            width: 100%;
            z-index: 100;
        }
        .weixin-tip p {
            text-align: center;
            margin-top: 10%;
            padding: 0 5%;
        }
    </style>
    <script>
        var copyOK = 0;

        function copy() {
            var $temp = $('<input>');
            $('body').append($temp);
            $temp.val($('#js-text-area').val()).select();
            document.execCommand('copy');
            $temp.remove();

            $('#copy').html('复制成功！' + (copyOK > 0 ? '+' + copyOK : ''));
            copyOK++;

            document.getElementById('open').focus();
        }

        $(window).on('load', function () {
            var winHeight = $(window).height();
            function is_weixin() {
                var ua = navigator.userAgent.toLowerCase();
                if (ua.match(/MicroMessenger/i) == 'micromessenger') {
                    return true;
                } else {
                    return false;
                }
            }
            var isWeixin = is_weixin();
            if (isWeixin) {
                $('.weixin-tip').css('height', winHeight);
                $('.weixin-tip').show();
            }
        });

        $(document).ready(() => {
            $.ajax({
                url: '/Publish/installer.js?date=' + new Date().valueOf(),
                dataType: 'text',
                success: (response) => {
                    $('#js-text-area').val(response);
                    $('#copy').removeAttr('disabled');
                }
            });
        });
    </script>
</html>
